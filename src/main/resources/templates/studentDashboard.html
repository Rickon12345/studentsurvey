<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Getting Started: Serving Web Content</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>

    <script src="https://cdn.amcharts.com/lib/5/index.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/xy.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/hierarchy.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/themes/Animated.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/locales/de_DE.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/geodata/germanyLow.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/fonts/notosans-sc.js"></script>
    <style>
        #chartdiv {
          width: 50%;
          max-width: 50%;
          height: 550px;
        }
    </style>
    <script th:inline="javascript">
  function convertToHierarchy(data) {
      return {
        name: data.participant.firstName,
        value: data.participant.id,
        children: data.fl ? data.fl.map(convertToHierarchy) : null
      };
    }
        // Transform backend data into desired JavaScript format

        var hierarchyChartData = convertToHierarchy(/*[[${friends[0]}]]*/);

            am5.ready(function() {
                var root = am5.Root.new("chartdiv");

                root.setThemes([
                  am5themes_Animated.new(root)
                ]);

                var data = hierarchyChartData;

                var container = root.container.children.push(am5.Container.new(root, {
                  width: am5.percent(100),
                  height: am5.percent(100),
                  layout: root.verticalLayout
                }));
                var series = container.children.push(am5hierarchy.ForceDirected.new(root, {
                  singleBranchOnly: false,
                  downDepth: 2,
                  topDepth: 1,
                  initialDepth: 1,
                  valueField: "value",
                  categoryField: "name",
                  childDataField: "children",
                  idField: "name",
                  linkWithField: "linkWith",
                  manyBodyStrength: -10,
                  centerStrength: 0.8,
                  minRadius: 10,
                  maxRadius: am5.percent(2)
                }));

                series.get("colors").setAll({
                  step: 2
                });

                series.links.template.set("strength", 0.5);
                series.data.setAll([data]);
                series.set("selectedDataItem", series.dataItems[0]);
                series.appear(1000, 100);
                });
    </script>
</head>
<body>
<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
    <!-- Brand/logo -->
    <a class="navbar-brand" href="#">Bright Boost</a>

    <!-- Links -->
    <ul class="navbar-nav">
        <li class="nav-item">
            <a class="nav-link" th:href="@{/students}">Students</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" th:href="@{/teachers}">Teachers</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" th:href="@{/courses}">Courses</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" th:href="@{/classes}">Classes</a>
        </li>
    </ul>
</nav>

<div class="container-fluid">
    <table class="table table-striped table-bordered">
        <tr>
            <th>ID</th>
            <th>firstName</th>
            <th>lastName</th>
            <th>perc effort</th>
            <th>attendance</th>
            <th>perc academic</th>
            <th>completeYears</th>
            <th>house</th>
            <th>survey date</th>
        </tr>
        <tr th:if="${#lists.isEmpty(participants)}">
            <td colspan="5">No Records found. Add some...!</td>
        </tr>
        <tr th:each="participant : ${participants}">
            <td th:text="${participant.id}"></td>
            <td th:text="${participant.firstName}"></td>
            <td th:text="${participant.lastName}"></td>
            <td th:text="${participant.email}"></td>
            <td th:text="${participant.percEffort}"></td>
            <td th:text="${participant.attendance}"></td>
            <td th:text="${participant.percAcademic}"></td>
            <td th:text="${participant.completeYears}"></td>
            <td th:text="${participant.house}"></td>
            <td th:text="${participant.surveyDate}"></td>
        </tr>
    </table>
</div>
<div>
    <table class="table table-striped table-bordered">
        <tr>
            <th>ID</th>
            <th>firstName</th>
            <th>lastName</th>
            <th>perc effort</th>
            <th>attendance</th>
            <th>perc academic</th>
            <th>completeYears</th>
            <th>house</th>
            <th>survey date</th>
        </tr>
        <tr th:if="${#lists.isEmpty(friends)}">
            <td colspan="5">No Records found. Add some...!</td>
        </tr>
        <tr th:each="friend : ${friends}">
            <td th:text="${friend.participantId}"></td>
        </tr>
    </table>
</div>
<!-- HTML -->
<div id="chartdiv"></div>
</body>
</html>